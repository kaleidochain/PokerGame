{"version":3,"sources":["assets/scripts/components/RoomEventMgr.js"],"names":["Log","require","cc","Class","Component","properties","onLoad","dgame","roomEventMgr","onDestroy","net","removeEventListener","start","startListen","addEventListener","_onRoomEvent","bind","data","Trace","JSON","stringify","Event","handleCreateTable","Params","handleNewClub","handleJoinClub","handleJoinClubApproved","handleNewApprove","_handleConnectStatus","statusInfo","tips","director","getScene","name","Status","showReConnecttingTips","subGameTable_cmd","TableId","tableInfo","gameCall","showReConnectSuccessTips"],"mappings":"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","sourceRoot":"/","sourcesContent":["var Log = require(\"Log\");\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        if (!cc.dgame) {\n            return;\n        }\n        cc.dgame.roomEventMgr = this;\n    },\n\n    onDestroy () {\n        if (!!cc.dgame) {\n            cc.dgame.net.removeEventListener([\"roomEvent\"]);\n            cc.dgame.roomEventMgr = null;\n        }\n    },\n\n    start () {\n\n    },\n\n    startListen () {\n        cc.dgame.net.addEventListener([\"roomEvent\", 0], this._onRoomEvent.bind(this));\n    },\n\n    _onRoomEvent (data) {\n        Log.Trace(\"[_onRoomEvent] \" + JSON.stringify(data));\n        if (data.Event == \"CreateTable\") {\n            if (!!this.handleCreateTable) {\n                this.handleCreateTable(data.Params);\n            } else {\n                Log.Trace(\"ignore CreateTable event\");\n            }\n        } else if (data.Event == \"NewClub\") {\n            if (!!this.handleNewClub) {\n                this.handleNewClub(data.Params);\n            } else {\n                Log.Trace(\"ignore NewClub event\");\n            }\n        } else if (data.Event == \"JoinClub\") {\n            if (!!this.handleJoinClub) {\n                this.handleJoinClub(data.Params);\n            } else {\n                Log.Trace(\"ignore JoinClub event\");\n            }\n        } else if (data.Event == \"JoinClubApproved\") {\n            if (!!this.handleJoinClubApproved) {\n                this.handleJoinClubApproved(data.Params);\n            } else {\n                Log.Trace(\"ignore JoinClubApproved event\");\n            }\n        } else if (data.Event == \"newApprove\") {\n            if (!!this.handleNewApprove) {\n                this.handleNewApprove(data.Params);\n            } else {\n                Log.Trace(\"ignore newApprove event\");\n            }\n        } else if (data.Event == \"ConnectStatus\") {\n            this._handleConnectStatus(data.Params);\n        }\n    },\n\n\n    _handleConnectStatus (statusInfo) {\n        Log.Trace(\"[_handleConnectStatus] \" + JSON.stringify(statusInfo) +\n            \", cc.dgame.tips: \" + cc.dgame.tips + \", scene: \" + cc.director.getScene().name);\n        if (statusInfo.Status == false) {\n            cc.dgame.tips.showReConnecttingTips();\n        } else {\n            if (cc.director.getScene().name == 'GameTable') {\n                let subGameTable_cmd = {\n                    TableId: cc.dgame.tableInfo.TableId,\n                }\n                cc.dgame.net.gameCall([\"reSubscribeGameTable\", JSON.stringify(subGameTable_cmd)]);\n            }\n            cc.dgame.net.gameCall([\"reSubscribeClub\", \"\"]);\n            cc.dgame.tips.showReConnectSuccessTips();\n        }\n    },\n\n    // update (dt) {},\n});\n"]}