{"version":3,"sources":["assets/scripts/Game/Invitation.js"],"names":["Log","require","cc","Class","Component","properties","invitationRule","Node","invitationProfits","enterInvitationCode","myInvitationCodeRule","RichText","myInvitationCodeProfits","inviterInvitationCode","richtextInviterInvitationCode","editboxInvitationCode","EditBox","btnConfirm","invitedNum","cumulativeIncomeNum","todayEarningNum","normalLoadingLayer","onLoad","dgame","invitation","Scene","active","startCheck","result","InvitationCode","i","length","string","utils","formatRichText","InvitedNum","TotalReward","InviterInvitationCode","node","start","onBtnBackClicked","director","loadScene","onBtnCopyInvitationCodeClicked","clipboard","copyToClipboard","tips","showTips","onBtnShareClicked","shareContent","sys","isNative","isMobile","os","OS_IOS","jsb","reflection","callStaticMethod","OS_ANDROID","onBtnRuleClicked","onBtnProfitsClicked","_onSetCode","normalLoading","stopInvokeWaiting","Trace","showLoadTimeout","onBtnConfirmClicked","startInvokeWaiting","setcode_cmd","net","gameCall","JSON","stringify","bind"],"mappings":"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","sourceRoot":"/","sourcesContent":["var Log = require(\"Log\");\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        invitationRule: cc.Node,\n        invitationProfits: cc.Node,\n        enterInvitationCode: cc.Node,\n\n        myInvitationCodeRule: cc.RichText,\n        myInvitationCodeProfits: cc.RichText,\n        \n        inviterInvitationCode: cc.Node,\n        richtextInviterInvitationCode: cc.RichText,\n        editboxInvitationCode: cc.EditBox,\n        btnConfirm: cc.Node,\n        \n        invitedNum: cc.RichText,\n        cumulativeIncomeNum: cc.RichText,\n        todayEarningNum: cc.RichText,\n\n        normalLoadingLayer: cc.Node,\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        if (cc.dgame.invitation.Scene == \"invitationRule\") {\n            this.invitationRule.active = true;\n            this.invitationProfits.active = false;\n            this.enterInvitationCode.active = false;\n            cc.dgame.invitation.startCheck();\n        } else if (cc.dgame.invitation.Scene == \"invitationProfits\") {\n            this.invitationRule.active = false;\n            this.invitationProfits.active = true;\n            this.enterInvitationCode.active = false;\n        } else if (cc.dgame.invitation.Scene == \"enterInvitationCode\") {\n            this.invitationRule.active = false;\n            this.invitationProfits.active = false;\n            this.enterInvitationCode.active = true;\n        }\n        let result = cc.dgame.invitation.InvitationCode[0];\n        for (let i = 1; i < cc.dgame.invitation.InvitationCode.length; i++) {\n            result += \" \" + cc.dgame.invitation.InvitationCode[i];\n        }\n        //result.replace(/\\s*/g,'') //去掉字符串中所有空格\n        this.myInvitationCodeRule.string = cc.dgame.utils.formatRichText(result, \"#ffffff\", true, false);\n        this.myInvitationCodeProfits.string = cc.dgame.utils.formatRichText(result, \"#ffffff\", true, false);\n        this.invitedNum.string = cc.dgame.utils.formatRichText(cc.dgame.invitation.InvitedNum, \"#D1D1D1\", true, true);\n        this.cumulativeIncomeNum.string = cc.dgame.utils.formatRichText(cc.dgame.invitation.TotalReward, \"#DA8B23\", true, true);\n        if (!!cc.dgame.invitation.InviterInvitationCode && cc.dgame.invitation.InviterInvitationCode != \"\") {\n            this.richtextInviterInvitationCode.string = cc.dgame.utils.formatRichText(cc.dgame.invitation.InviterInvitationCode, \"#16487C\", true, false);\n            this.inviterInvitationCode.active = true;\n            this.editboxInvitationCode.node.active = false;\n            this.btnConfirm.active = false;\n        } else {\n            this.inviterInvitationCode.active = false;\n            this.editboxInvitationCode.node.active = true;\n            this.btnConfirm.active = true;\n        }\n    },\n\n    start () {\n\n    },\n\n    onBtnBackClicked () {\n        cc.director.loadScene(\"MySettings\");\n    },\n\n    onBtnCopyInvitationCodeClicked () {\n        cc.dgame.clipboard.copyToClipboard(cc.dgame.invitation.InvitationCode);\n        cc.dgame.tips.showTips(\"Copy<br/>Succeed\");\n    },\n\n    onBtnShareClicked () {\n        let shareContent = \"Play Block Poker with me！The world's first blockchain Texas Holdem, the safest and fairest cash poker platform with permanent operation and assets.\\nMy Invitation Code:\" + cc.dgame.invitation.InvitationCode;\n        cc.dgame.clipboard.copyToClipboard(shareContent);\n        cc.dgame.tips.showTips(\"The invitation information <br/>has been copied, please paste it.\", 2 / 3);\n        if (cc.sys.isNative) {\n            if (cc.sys.isMobile) {\n                if (cc.sys.os === cc.sys.OS_IOS) {\n                    jsb.reflection.callStaticMethod('NativeGengine', 'Share:', shareContent);\n                } else if (cc.sys.os === cc.sys.OS_ANDROID) {\n                    jsb.reflection.callStaticMethod('org/cocos2dx/javascript/AppActivity', 'Share', '(Ljava/lang/String;Ljava/lang/String;)V', \"Play Block Poker with me！\", shareContent);\n                }\n            } else {\n\n            }\n        }\n    },\n\n    onBtnRuleClicked () {\n        this.invitationRule.active = true;\n        this.invitationProfits.active = false;\n        this.enterInvitationCode.active = false;\n    },\n\n    onBtnProfitsClicked () {\n        this.invitationRule.active = false;\n        this.invitationProfits.active = true;\n        this.enterInvitationCode.active = false;\n    },\n\n    _onSetCode (result) {\n        cc.dgame.normalLoading.stopInvokeWaiting();\n        Log.Trace(\"[_onSetCode] setCode(\" + this.editboxInvitationCode.string + \") return \" + result);\n        if (result == \"Network disconnected\") {\n            cc.dgame.normalLoading.showLoadTimeout();\n            return;\n        }\n        if (result == \"\") {\n            cc.dgame.invitation.InviterInvitationCode = this.editboxInvitationCode.string;\n            this.richtextInviterInvitationCode.string = cc.dgame.utils.formatRichText(cc.dgame.invitation.InviterInvitationCode, \"#16487C\", true, false);\n            this.inviterInvitationCode.active = true;\n            this.editboxInvitationCode.node.active = false;\n            this.btnConfirm.active = false;\n            cc.dgame.tips.showTips(\"Successfully bound inviter\");\n        } else {\n            this.inviterInvitationCode.active = false;\n            this.editboxInvitationCode.node.active = true;\n            this.btnConfirm.active = true;\n            cc.dgame.tips.showTips(result);\n        }\n    },\n\n    onBtnConfirmClicked () {\n        cc.dgame.normalLoading.startInvokeWaiting();\n        var setcode_cmd = {\n            InvitationCode: this.editboxInvitationCode.string,\n        }\n        cc.dgame.net.gameCall([\"setCode\", JSON.stringify(setcode_cmd)], this._onSetCode.bind(this));\n    },\n\n    // update (dt) {},\n});\n"]}