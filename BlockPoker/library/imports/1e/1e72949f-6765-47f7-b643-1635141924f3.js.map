{"version":3,"sources":["assets/scripts/components/OperationTips.js"],"names":["Log","require","cc","Class","Component","properties","_tipsLayer","Node","_tipsBackground","_tips","RichText","_reconnectTipsLayer","_reconnectTipsBackGround","_reconnectTipsLabel","Label","onLoad","dgame","find","getComponent","tips","showTips","height","stopAllActions","string","utils","formatRichText","node","width","pos","v2","winSize","setPosition","parent","convertToNodeSpaceAR","opacity","active","runAction","sequence","delayTime","fadeOut","callFunc","showReConnecttingTips","Trace","resizeBackGround","tipsCarousel","showReConnectSuccessTips","normalLoading","onBtnOKClicked","overflow","Overflow","NONE","setContentSize","Size","_forceUpdateRenderData","textWidth","Math","min","round","RESIZE_HEIGHT","textHeight","start","onDestroy"],"mappings":"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","sourceRoot":"/","sourcesContent":["var Log = require('Log');\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        _tipsLayer: cc.Node,\n        _tipsBackground: cc.Node,\n        _tips: cc.RichText,\n        _reconnectTipsLayer: cc.Node,\n        _reconnectTipsBackGround: cc.Node,\n        _reconnectTipsLabel: cc.Label,\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        if (!cc.dgame) {\n            return;\n        }\n        this._tipsLayer = cc.find(\"Canvas/TipsLayer\");\n        this._tipsBackground = cc.find(\"Canvas/TipsLayer/bg_tips\");\n        this._tips = cc.find(\"Canvas/TipsLayer/bg_tips/richtext\").getComponent(cc.RichText);\n        this._reconnectTipsLayer = cc.find(\"Canvas/ReconnectTipsLayer\");\n        if (this._reconnectTipsLayer != null) {\n            this._reconnectTipsBackGround = cc.find(\"Canvas/ReconnectTipsLayer/bg_reconnect_tips\");\n            this._reconnectTipsLabel = cc.find(\"Canvas/ReconnectTipsLayer/bg_reconnect_tips/label\").getComponent(cc.Label);\n        }\n        cc.dgame.tips = this;\n    },\n\n    showTips (tips, height) {\n        if (!height) {\n            height = 0.5;\n        }\n        this._tipsLayer.stopAllActions();\n        this._tips.string = cc.dgame.utils.formatRichText(tips, \"#AFC6DD\", true, false);\n        if (this._tips.node.width + 40 > 426) {\n            this._tipsBackground.width = this._tips.node.width + 200;\n            let pos = cc.v2(cc.winSize.width / 2, cc.winSize.height * height);\n            this._tipsBackground.setPosition(this._tipsBackground.parent.convertToNodeSpaceAR(pos));\n        }\n        this._tipsLayer.opacity = 255;\n        this._tipsLayer.active = true;\n        this._tipsLayer.runAction(\n            cc.sequence(\n                cc.delayTime(1.5),\n                cc.fadeOut(1),\n                cc.callFunc(function () {\n                    this._tipsBackground.setPosition(0, 0);\n                    this._tipsBackground.width = 426;\n                    this._tipsLayer.active = false;\n                }, this),\n            ),\n        );\n    },\n\n    showReConnecttingTips() {\n        Log.Trace('[showReConnecttingTips] this._reconnectTipsLayer: ' + this._reconnectTipsLayer);\n        if (this._reconnectTipsLayer == null) {\n            return;\n        }\n        this._reconnectTipsLayer.stopAllActions();\n        this._reconnectTipsLabel.string = \"Reconnecting...\"\n        this.resizeBackGround();\n        this._reconnectTipsLayer.opacity = 255;\n        this._reconnectTipsLayer.active = true;\n        cc.dgame.utils.tipsCarousel(this._reconnectTipsLayer,this._reconnectTipsLabel,\"Reconnecting\",1);\n        Log.Trace('[showReConnecttingTips]');\n    },\n\n    showReConnectSuccessTips() {\n        Log.Trace('[showReConnectSuccessTips] this._reconnectTipsLayer: ' + this._reconnectTipsLayer);\n        cc.dgame.normalLoading.onBtnOKClicked();\n        if (this._reconnectTipsLayer == null) {\n            return;\n        }\n        this._reconnectTipsLabel.string = \"Reconnected successfully\";\n        this._reconnectTipsLayer.stopAllActions();\n        this.resizeBackGround();\n        this._reconnectTipsLayer.active = true;\n        this._reconnectTipsLayer.runAction(\n            cc.sequence(\n                cc.delayTime(1.5),\n                cc.fadeOut(1),\n            ),\n        );\n        Log.Trace('[showReConnectSuccessTips]');\n    },\n\n    resizeBackGround() {\n        this._reconnectTipsLabel.overflow = cc.Label.Overflow.NONE;\n        this._reconnectTipsLabel.node.setContentSize(new cc.Size(0, 42));\n        this._reconnectTipsLabel._forceUpdateRenderData();\n        let textWidth = Math.min(this._reconnectTipsLabel.node.width, 450);\n        textWidth = Math.round(textWidth / 30) * 30;\n\n        this._reconnectTipsLabel.overflow = cc.Label.Overflow.RESIZE_HEIGHT;\n        this._reconnectTipsLabel.node.setContentSize(new cc.Size(textWidth, 0));\n        this._reconnectTipsLabel._forceUpdateRenderData();\n        let textHeight = this._reconnectTipsLabel.node.height;\n\n        this._reconnectTipsLabel.node.width = textWidth;\n        this._reconnectTipsLabel.node.height = textHeight;\n\n        this._reconnectTipsBackGround.parent.active = true;\n        this._reconnectTipsBackGround.width = this._reconnectTipsLabel.node.width + 60;\n        this._reconnectTipsBackGround.height = this._reconnectTipsLabel.node.height + 15;\n    },\n\n    start () {\n\n    },\n\n    onDestroy () {\n        if (!!cc.dgame) {\n            cc.dgame.tips = null;\n        }\n    },\n    // update (dt) {},\n});\n"]}