{"version":3,"sources":["assets/scripts/Game/GameRequestItem.js"],"names":["Log","require","cc","Class","Component","properties","tableInfoLayer","Node","requestLayer","resultLayer","fulltableid","Label","creatorAddr","requestAvator","Sprite","requestAccountAddr","requestBuyinNum","resultAvator","resultAccountAddr","resultBuyinNum","result","init","gameRequest","Trace","JSON","stringify","Type","active","string","CreatorAddr","substr","clubid","Math","floor","parseFloat","TableId","tableid","toString","assetMgr","find","getComponent","idx","parseInt","Addr","isNaN","spriteFrame","heads","BuyinNum","accountAddr","Sender","Result","update","dt","approve","director","getScene","name","gameRequestMgr","deny"],"mappings":"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","sourceRoot":"/","sourcesContent":["var Log = require(\"Log\");\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        tableInfoLayer: cc.Node,\n        requestLayer: cc.Node,\n        resultLayer: cc.Node,\n        fulltableid: cc.Label,\n        creatorAddr: cc.Label,\n        requestAvator: cc.Sprite,\n        requestAccountAddr: cc.Label,\n        requestBuyinNum: cc.Label,\n        resultAvator: cc.Sprite,\n        resultAccountAddr: cc.Label,\n        resultBuyinNum: cc.Label,\n        result: cc.Label,\n    },\n\n    // use this for initialization\n    init (gameRequest) {\n        Log.Trace(\"gameRequest: \" + JSON.stringify(gameRequest));\n        if (gameRequest.Type == \"TableInfo\") {\n            this.tableInfoLayer.active = true;\n            this.requestLayer.active = false;\n            this.resultLayer.active = false;\n            this.creatorAddr.string = gameRequest.CreatorAddr.substr(2, 8);\n            let clubid = Math.floor(parseFloat(gameRequest.TableId) / 0x10000000);\n            let tableid = parseFloat(gameRequest.TableId) - clubid * 0x10000000;\n            this.fulltableid.string = clubid + \" - \";\n            if (tableid < 10) {\n                this.fulltableid.string += '00' + tableid.toString();\n            } else if (tableid < 100) {\n                this.fulltableid.string += '0' + tableid.toString();\n            } else {\n                this.fulltableid.string += this.tableid.toString();\n            }\n        } else if (gameRequest.Type == \"Request\") {\n            this.tableInfoLayer.active = false;\n            this.requestLayer.active = true;\n            this.resultLayer.active = false;\n            let assetMgr = cc.find(\"AssetMgr\").getComponent(\"AssetMgr\");\n            var idx = parseInt(gameRequest.Addr.substr(2, 2), 16);\n            if (isNaN(idx)) {\n                idx = 0;\n            }\n            this.requestAvator.spriteFrame = assetMgr.heads[idx % 200];\n            this.requestAccountAddr.string = gameRequest.Addr.substr(2, 8);\n            this.requestBuyinNum.string = gameRequest.BuyinNum;\n            this.accountAddr = gameRequest.Addr\n        } else if (gameRequest.Type == \"Result\") {\n            this.tableInfoLayer.active = false;\n            this.requestLayer.active = false;\n            this.resultLayer.active = true;\n            let assetMgr = cc.find(\"AssetMgr\").getComponent(\"AssetMgr\");\n            var idx = parseInt(gameRequest.Addr.substr(2, 2), 16);\n            if (isNaN(idx)) {\n                idx = 0;\n            }\n            this.resultAvator.spriteFrame = assetMgr.heads[idx % 200];\n            this.resultAccountAddr.string = gameRequest.Addr.substr(2, 8);\n            this.resultBuyinNum.string = gameRequest.BuyinNum;\n            this.result.string = gameRequest.Sender.substr(2, 8);\n            if (gameRequest.Result == 1) {\n                this.result.string += \" Approved\";\n            } else {\n                this.result.string += \" Denied\";\n            }\n        }\n    },\n\n    // called every frame\n    update (dt) {\n\n    },\n\n    approve () {\n        Log.Trace(\"[approve] scene: \" + cc.director.getScene().name);\n        var gameRequestMgr = cc.find(cc.director.getScene().name).getComponent(\"GameRequestMgr\");\n        gameRequestMgr.approve(this.accountAddr);\n    },\n\n    deny () {\n        var gameRequestMgr = cc.find(cc.director.getScene().name).getComponent(\"GameRequestMgr\");\n        gameRequestMgr.deny(this.accountAddr);\n    },\n});\n"]}